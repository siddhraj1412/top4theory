<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 4 Theory - Cinema Level Calculator</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé¨</text></svg>">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6MXK1C0WSL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6MXK1C0WSL');
    </script>
    
    <!-- html2canvas for screenshots -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="background-gradient"></div>
    
    <div class="container">
        <header class="header">
            <h1 class="logo">üé¨ Top 4 <span class="highlight">Theory</span></h1>
            <p class="tagline">Discover your true Cinema Level based on your favorite films</p>
            <a href="https://letterboxd.com/SiddhrajThakor/" target="_blank" class="creator-badge">
                by @SiddhrajThakor
            </a>
        </header>

        <div class="movie-selection-section">
            <h2 class="selection-title">üé• Select Your Top 4 Favorite Films</h2>
            <p class="selection-subtitle">Search and select your 4 favorite movies of all time</p>
            
            <!-- Search Overlay -->
            <div class="search-overlay" id="searchOverlay" onclick="closeSearch()"></div>
            
            <!-- Global Search Modal -->
            <div class="search-container" id="searchModal">
                <input type="text" class="movie-search" id="movieSearchInput" placeholder="Type a movie name..." autocomplete="off">
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="movie-slots">
                <!-- Slot 1 -->
                <div class="movie-slot" data-slot="1" onclick="openSearch(1)">
                    <div class="slot-number">1</div>
                    <div class="slot-content empty" id="slot-1">
                        <div class="empty-state">
                            <span class="empty-icon">üé¨</span>
                            <span class="empty-text">Click to add movie</span>
                        </div>
                        <div class="selected-movie" style="display: none;">
                            <img class="selected-poster" src="" alt="">
                            <div class="selected-info">
                                <div class="selected-title"></div>
                                <div class="selected-year"></div>
                            </div>
                            <button class="remove-btn" onclick="event.stopPropagation(); removeMovie(1)">‚úï</button>
                        </div>
                    </div>
                </div>
                
                <!-- Slot 2 -->
                <div class="movie-slot" data-slot="2" onclick="openSearch(2)">
                    <div class="slot-number">2</div>
                    <div class="slot-content empty" id="slot-2">
                        <div class="empty-state">
                            <span class="empty-icon">üé¨</span>
                            <span class="empty-text">Click to add movie</span>
                        </div>
                        <div class="selected-movie" style="display: none;">
                            <img class="selected-poster" src="" alt="">
                            <div class="selected-info">
                                <div class="selected-title"></div>
                                <div class="selected-year"></div>
                            </div>
                            <button class="remove-btn" onclick="event.stopPropagation(); removeMovie(2)">‚úï</button>
                        </div>
                    </div>
                </div>
                
                <!-- Slot 3 -->
                <div class="movie-slot" data-slot="3" onclick="openSearch(3)">
                    <div class="slot-number">3</div>
                    <div class="slot-content empty" id="slot-3">
                        <div class="empty-state">
                            <span class="empty-icon">üé¨</span>
                            <span class="empty-text">Click to add movie</span>
                        </div>
                        <div class="selected-movie" style="display: none;">
                            <img class="selected-poster" src="" alt="">
                            <div class="selected-info">
                                <div class="selected-title"></div>
                                <div class="selected-year"></div>
                            </div>
                            <button class="remove-btn" onclick="event.stopPropagation(); removeMovie(3)">‚úï</button>
                        </div>
                    </div>
                </div>
                
                <!-- Slot 4 -->
                <div class="movie-slot" data-slot="4" onclick="openSearch(4)">
                    <div class="slot-number">4</div>
                    <div class="slot-content empty" id="slot-4">
                        <div class="empty-state">
                            <span class="empty-icon">üé¨</span>
                            <span class="empty-text">Click to add movie</span>
                        </div>
                        <div class="selected-movie" style="display: none;">
                            <img class="selected-poster" src="" alt="">
                            <div class="selected-info">
                                <div class="selected-title"></div>
                                <div class="selected-year"></div>
                            </div>
                            <button class="remove-btn" onclick="event.stopPropagation(); removeMovie(4)">‚úï</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="selection-counter">
                <span id="selectedCount">0</span>/4 films selected
            </div>
            
            <button onclick="analyzeTop4()" id="analyzeBtn" class="analyze-btn" disabled>
                <span class="btn-text">ANALYZE MY TOP 4</span>
                <span class="btn-loader hidden">‚è≥</span>
            </button>
        </div>

        <div id="error" class="error-box hidden"></div>

        <div id="result" class="result hidden">
            <div class="shareable-content" id="shareableContent">
                <!-- 1. LEVEL / RANK CARD -->
                <div class="rank-card" id="rankCard">
                    <div class="tier-badge" id="tierBadge">
                        <span class="tier-icon" id="tierIcon">üì∫</span>
                    </div>
                    <div class="rank-info">
                        <div class="tier-level">Level <span id="levelVal">1</span></div>
                        <div class="tier-name" id="tierName">The Casual Viewer</div>
                        <div class="tier-description" id="tierDescription">You watch movies to kill time.</div>
                    </div>
                    <div class="score-section">
                        <div class="score-item">
                            <div class="score-value" id="scoreVal">0</div>
                            <div class="score-label">Score</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value"><span id="avgRating">‚òÜ</span></div>
                            <div class="score-label">Avg Rating</div>
                        </div>
                    </div>
                </div>

                <!-- 2. TOP 4 ANALYSIS BREAKDOWN -->
                <div class="analysis-section">
                    <h3>üìä Top 4 Analysis Breakdown</h3>
                    <div class="analysis-grid" id="analysisGrid"></div>
                </div>

                <!-- 3. WHY THIS RANK -->
                <div class="reasons-section">
                    <h3>üîç Why This Rank?</h3>
                    <ul id="reasonsList"></ul>
                </div>

                <!-- 4. YOUR TOP 4 FILMS -->
                <div class="movies-section">
                    <h3>üé• Your Top 4 Films</h3>
                    <div class="movie-grid" id="movieGrid"></div>
                </div>

                <!-- 5. WHY THIS TIER - Upgraded with progress bar -->
                <div class="tier-explanation-section">
                    <h3>üí° Why This Tier?</h3>
                    <p id="tierExplanation"></p>
                    <ul id="tierFactors" class="tier-factors-list"></ul>
                    <div class="level-progress">
                        <span class="level-label">Level 1</span>
                        <div class="level-progress-bar">
                            <div class="level-progress-fill" id="levelProgressFill"></div>
                            <span class="level-score" id="levelScoreDisplay">Score: 0/100</span>
                        </div>
                        <span class="level-label">Level 10</span>
                    </div>
                </div>

                <!-- 6. YOUR TASTE PROFILE -->
                <div class="taste-profile-section">
                    <h3>üé≠ Your Taste Profile</h3>
                    <div class="taste-profile-content">
                        <p class="taste-subtitle">What your Top 4 reveals:</p>
                        <p id="tasteDescription"></p>
                        <div class="taste-stats" id="tasteStats"></div>
                    </div>
                </div>

                <!-- 7. SCORE BREAKDOWN WITH PROGRESS BARS -->
                <div class="breakdown-section">
                    <h3>üìä Score Breakdown</h3>
                    <p class="breakdown-subtitle">How we calculated your score:</p>
                    <div class="score-breakdown" id="scoreBreakdown"></div>
                </div>
            </div>
        </div>

        <div class="tiers-section">
            <h2>üèÜ The 10-Level Cinema Hierarchy</h2>
            <div class="tiers-grid" id="tiersGrid">
                <div class="tier-item" style="--tier-color: #6c757d">
                    <span class="tier-num">1</span>
                    <span class="tier-emoji">üì∫</span>
                    <span class="tier-title">The Casual Viewer</span>
                </div>
                <div class="tier-item" style="--tier-color: #fd7e14">
                    <span class="tier-num">2</span>
                    <span class="tier-emoji">üçø</span>
                    <span class="tier-title">The Popcorn Enthusiast</span>
                </div>
                <div class="tier-item" style="--tier-color: #20c997">
                    <span class="tier-num">3</span>
                    <span class="tier-emoji">üéüÔ∏è</span>
                    <span class="tier-title">The Avid Watcher</span>
                </div>
                <div class="tier-item" style="--tier-color: #0dcaf0">
                    <span class="tier-num">4</span>
                    <span class="tier-emoji">üåä</span>
                    <span class="tier-title">The Eclectic Explorer</span>
                </div>
                <div class="tier-item" style="--tier-color: #6f42c1">
                    <span class="tier-num">5</span>
                    <span class="tier-emoji">ü•É</span>
                    <span class="tier-title">The Dedicated Cinephile</span>
                </div>
                <div class="tier-item" style="--tier-color: #d63384">
                    <span class="tier-num">6</span>
                    <span class="tier-emoji">üé©</span>
                    <span class="tier-title">The Refined Curator</span>
                </div>
                <div class="tier-item" style="--tier-color: #ffc107">
                    <span class="tier-num">7</span>
                    <span class="tier-emoji">üç∑</span>
                    <span class="tier-title">The Cinema Connoisseur</span>
                </div>
                <div class="tier-item" style="--tier-color: #198754">
                    <span class="tier-num">8</span>
                    <span class="tier-emoji">üéûÔ∏è</span>
                    <span class="tier-title">The Elite Cinephile</span>
                </div>
                <div class="tier-item" style="--tier-color: #dc3545">
                    <span class="tier-num">9</span>
                    <span class="tier-emoji">üëÅÔ∏è</span>
                    <span class="tier-title">The Master Curator</span>
                </div>
                <div class="tier-item legendary" style="--tier-color: #ffd700">
                    <span class="tier-num">10</span>
                    <span class="tier-emoji">üèÜ</span>
                    <span class="tier-title">The Cinema Deity</span>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-buttons">
                    <a href="https://forms.gle/2arhuQwDaCs94Rn59" target="_blank" class="footer-btn feedback-btn">
                        Send Feedback
                    </a>
                    <a href="https://buymeacoffee.com/siddhrajthakor" target="_blank" class="footer-btn coffee-btn">
                        Buy me a coffee
                    </a>
                </div>
                
                <p class="footer-note">Rating shown is out of 5 stars (multiply by 2 for TMDB's /10 scale)</p>
                <p class="footer-credits">Built with ‚ù§Ô∏è by <a href="https://letterboxd.com/SiddhrajThakor/" target="_blank" class="footer-link">@SiddhrajThakor</a> | Data from TMDB</p>
            </div>
        </footer>
    </div>
    
    <script src="script.js"></script>
</body>
</html>
